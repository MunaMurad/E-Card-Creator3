{"ast":null,"code":"/**\r\n * Alignment pattern are fixed reference pattern in defined positions\r\n * in a matrix symbology, which enables the decode software to re-synchronise\r\n * the coordinate mapping of the image modules in the event of moderate amounts\r\n * of distortion of the image.\r\n *\r\n * Alignment patterns are present only in QR Code symbols of version 2 or larger\r\n * and their number depends on the symbol version.\r\n */\nvar getSymbolSize = require('./utils').getSymbolSize;\n/**\r\n * Calculate the row/column coordinates of the center module of each alignment pattern\r\n * for the specified QR Code version.\r\n *\r\n * The alignment patterns are positioned symmetrically on either side of the diagonal\r\n * running from the top left corner of the symbol to the bottom right corner.\r\n *\r\n * Since positions are simmetrical only half of the coordinates are returned.\r\n * Each item of the array will represent in turn the x and y coordinate.\r\n * @see {@link getPositions}\r\n *\r\n * @param  {Number} version QR Code version\r\n * @return {Array}          Array of coordinate\r\n */\n\n\nexports.getRowColCoords = function getRowColCoords(version) {\n  if (version === 1) return [];\n  var posCount = Math.floor(version / 7) + 2;\n  var size = getSymbolSize(version);\n  var intervals = size === 145 ? 26 : Math.ceil((size - 13) / (2 * posCount - 2)) * 2;\n  var positions = [size - 7]; // Last coord is always (size - 7)\n\n  for (var i = 1; i < posCount - 1; i++) {\n    positions[i] = positions[i - 1] - intervals;\n  }\n\n  positions.push(6); // First coord is always 6\n\n  return positions.reverse();\n};\n/**\r\n * Returns an array containing the positions of each alignment pattern.\r\n * Each array's element represent the center point of the pattern as (x, y) coordinates\r\n *\r\n * Coordinates are calculated expanding the row/column coordinates returned by {@link getRowColCoords}\r\n * and filtering out the items that overlaps with finder pattern\r\n *\r\n * @example\r\n * For a Version 7 symbol {@link getRowColCoords} returns values 6, 22 and 38.\r\n * The alignment patterns, therefore, are to be centered on (row, column)\r\n * positions (6,22), (22,6), (22,22), (22,38), (38,22), (38,38).\r\n * Note that the coordinates (6,6), (6,38), (38,6) are occupied by finder patterns\r\n * and are not therefore used for alignment patterns.\r\n *\r\n * var pos = getPositions(7)\r\n * // [[6,22], [22,6], [22,22], [22,38], [38,22], [38,38]]\r\n *\r\n * @param  {Number} version QR Code version\r\n * @return {Array}          Array of coordinates\r\n */\n\n\nexports.getPositions = function getPositions(version) {\n  var coords = [];\n  var pos = exports.getRowColCoords(version);\n  var posLength = pos.length;\n\n  for (var i = 0; i < posLength; i++) {\n    for (var j = 0; j < posLength; j++) {\n      // Skip if position is occupied by finder patterns\n      if (i === 0 && j === 0 || i === 0 && j === posLength - 1 || i === posLength - 1 && j === 0) {\n        // top-right\n        continue;\n      }\n\n      coords.push([pos[i], pos[j]]);\n    }\n  }\n\n  return coords;\n};","map":null,"metadata":{},"sourceType":"script"}