{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { NavController, AlertController } from '@ionic/angular';\nimport { UserService } from '../../../services/user.service';\nimport { ShoppingService } from '../../../services/shopping.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../services/shopping.service\";\nimport * as i2 from \"../../../services/user.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@ionic/angular\";\nimport * as i5 from \"@angular/common\";\n\nfunction ShoppingCartPage_div_8_ion_item_sliding_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-item-sliding\", 9, 13);\n    i0.ɵɵelementStart(2, \"ion-item\", 14);\n    i0.ɵɵelementStart(3, \"ion-thumbnail\", 1);\n    i0.ɵɵelement(4, \"ion-img\", 15);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-label\", 10);\n    i0.ɵɵelementStart(6, \"h3\");\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(8, \"p\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"p\");\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"h5\", 16);\n    i0.ɵɵtext(13);\n    i0.ɵɵpipe(14, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(15, \"ion-item-options\", 17);\n    i0.ɵɵelementStart(16, \"ion-item-option\", 18);\n    i0.ɵɵlistener(\"click\", function ShoppingCartPage_div_8_ion_item_sliding_2_Template_ion_item_option_click_16_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const i_r5 = restoredCtx.index;\n\n      const _r6 = i0.ɵɵreference(1);\n\n      const ctx_r7 = i0.ɵɵnextContext(2);\n      return ctx_r7.removeCartProduct(i_r5, _r6);\n    });\n    i0.ɵɵelement(17, \"ion-icon\", 19);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const item_r4 = ctx.$implicit;\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"src\", item_r4.image);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(item_r4.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Size: \", item_r4.size, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Color: \", item_r4.color, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind3(14, 5, item_r4.price, \"USD\", \"symbol\"));\n  }\n}\n\nfunction ShoppingCartPage_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"ion-list\");\n    i0.ɵɵtemplate(2, ShoppingCartPage_div_8_ion_item_sliding_2_Template, 18, 9, \"ion-item-sliding\", 8);\n    i0.ɵɵelementStart(3, \"ion-item\", 9);\n    i0.ɵɵelementStart(4, \"ion-label\", 10);\n    i0.ɵɵelementStart(5, \"h1\", 11);\n    i0.ɵɵtext(6, \"Total:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"h5\", 12);\n    i0.ɵɵtext(8);\n    i0.ɵɵpipe(9, \"currency\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.selectedItems);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind3(9, 2, ctx_r0.total, \"USD\", \"symbol\"));\n  }\n}\n\nfunction ShoppingCartPage_div_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 20);\n    i0.ɵɵelementStart(1, \"div\", 21);\n    i0.ɵɵelement(2, \"ion-icon\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 23);\n    i0.ɵɵelementStart(4, \"ion-text\", 24);\n    i0.ɵɵelementStart(5, \"h1\", 25);\n    i0.ɵɵtext(6, \"Your shopping cart is empty\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\");\n    i0.ɵɵelementStart(8, \"ion-button\", 26);\n    i0.ɵɵtext(9, \"Continue shopping\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction ShoppingCartPage_ion_footer_10_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-footer\");\n    i0.ɵɵelementStart(1, \"ion-toolbar\");\n    i0.ɵɵelementStart(2, \"ion-grid\", 5);\n    i0.ɵɵelementStart(3, \"ion-button\", 27);\n    i0.ɵɵlistener(\"click\", function ShoppingCartPage_ion_footer_10_Template_ion_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.checkout();\n    });\n    i0.ɵɵtext(4, \"Checkout\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-button\", 26);\n    i0.ɵɵtext(6, \"Continue shopping\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n}\n\nexport let ShoppingCartPage = /*#__PURE__*/(() => {\n  class ShoppingCartPage {\n    constructor(shoppingService, userService, activatedRoute, navController, router, alertController) {\n      this.shoppingService = shoppingService;\n      this.userService = userService;\n      this.activatedRoute = activatedRoute;\n      this.navController = navController;\n      this.router = router;\n      this.alertController = alertController;\n      this.selectedItems = [];\n      this.total = 0;\n      this.totalValue = 0; //**** User authentication  ****/\n\n      this.userAuth = false; // Is user logged in ?\n    }\n\n    ngOnInit() {}\n\n    ionViewWillEnter() {\n      return __awaiter(this, void 0, void 0, function* () {\n        //this.userAuth =  await this.userService.getAuthState();\n        this.userAuth = yield this.userService.isLoggedIn();\n        this.userId = yield this.userService.getUserId();\n        this.getCartProduct();\n        console.log(\"___this.userAuth=\" + this.userAuth);\n        console.log(\"___this.userId=\" + this.userId); // this.totalVat = this.total + ]\n      });\n    }\n\n    removeCartProduct(index, slidingItem) {\n      //this.productService.removeLocalCartProduct(product);\n      slidingItem.close();\n      console.log(\"removeCart\");\n      this.shoppingService.removeItemCart(index); // Recalling\n\n      this.getCartProduct();\n    }\n\n    getCartProduct() {\n      // this.cartProducts = this.productService.getLocalCartProducts();\n      const items = this.shoppingService.getCart();\n      console.log(\"page not refresh__________________food-cart : items=\" + items);\n      const selected = {};\n      this.totalValue = 0;\n\n      for (const obj of items) {\n        this.totalValue += obj.price;\n      }\n\n      this.selectedItems = items;\n      console.log(\"selected Addon=\" + this.selectedItems);\n      this.total = this.totalValue;\n    }\n\n    getCartSameProduct() {\n      // this.cartProducts = this.productService.getLocalCartProducts();\n      const items = this.shoppingService.getCart(); //console.log(\"page not refresh__________________shopping-cart : items=\"+items);\n\n      const selected = {};\n\n      for (const obj of items) {\n        if (selected[obj.itemId]) {\n          selected[obj.itemId].count++;\n        } else {\n          selected[obj.itemId] = Object.assign(Object.assign({}, obj), {\n            count: 1\n          });\n        }\n      }\n\n      this.selectedItems = Object.keys(selected).map(key => selected[key]);\n      console.log(\"selected Addon=\" + this.selectedItems);\n      this.total = this.selectedItems.reduce((a, b) => a + b.count * b.price, 0);\n    }\n\n    presentAlertConfirm() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const alert = yield this.alertController.create({\n          header: 'No permission',\n          message: 'You have to signin first!',\n          buttons: [{\n            text: 'Cancel',\n            role: 'cancel',\n            cssClass: 'secondary',\n            handler: blah => {\n              console.log('Confirm Cancel: blah');\n            }\n          }, {\n            text: 'Login',\n            handler: () => {\n              console.log('Go to login page');\n              this.router.navigateByUrl('/fire-signin?redirectUrl=shopping-checkout');\n            }\n          }]\n        });\n        yield alert.present();\n      });\n    } // checkout\n\n\n    checkout() {\n      //navigate to address page\n      // check if user already logged in?\n      if (!this.userAuth) {\n        // error: not login \n        // show popup\n        console.log(\"checkout()___userAuth = false\");\n        this.presentAlertConfirm();\n      } else {\n        // userAuth = true \n        console.log(\"checkout()___userAuth = true\");\n        this.router.navigateByUrl('/shopping-checkout');\n      } //\n\n    }\n\n  }\n\n  ShoppingCartPage.ɵfac = function ShoppingCartPage_Factory(t) {\n    return new (t || ShoppingCartPage)(i0.ɵɵdirectiveInject(i1.ShoppingService), i0.ɵɵdirectiveInject(i2.UserService), i0.ɵɵdirectiveInject(i3.ActivatedRoute), i0.ɵɵdirectiveInject(i4.NavController), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i4.AlertController));\n  };\n\n  ShoppingCartPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ShoppingCartPage,\n    selectors: [[\"app-shopping-cart\"]],\n    decls: 11,\n    vars: 3,\n    consts: [[1, \"ion-no-border\"], [\"slot\", \"start\"], [\"mode\", \"ios\", \"color\", \"warning\", \"defaultHref\", \"#\"], [\"color\", \"warning\"], [\"padding\", \"\"], [\"fixed\", \"\", 1, \"ion-no-padding\"], [4, \"ngIf\"], [\"text-center\", \"\", 4, \"ngIf\"], [\"lines\", \"none\", \"class\", \"ion-margin-top\", 4, \"ngFor\", \"ngForOf\"], [\"lines\", \"none\", 1, \"ion-margin-top\"], [1, \"text-left\"], [1, \"main-b-header8\"], [\"slot\", \"end\", \"text-right\", \"\", 1, \"main-b-header8\"], [\"slidingItem\", \"\"], [\"lines\", \"none\"], [3, \"src\"], [\"slot\", \"end\", \"text-right\", \"\", 1, \"main-header7\"], [\"side\", \"end\"], [3, \"click\"], [\"slot\", \"icon-only\", \"size\", \"small\", \"name\", \"trash\"], [\"text-center\", \"\"], [1, \"logo-box\"], [\"name\", \"bookmarks-outline\", \"color\", \"light\", 1, \"notification\", \"pop-in\"], [1, \"ion-text-center\"], [\"color\", \"ulightgrey\", 1, \"ion-margin-bottom\"], [1, \"main-header5\"], [\"color\", \"warning\", \"fill\", \"blank\", \"expand\", \"full\", \"routerLink\", \"/shopping-home\"], [\"color\", \"warning\", \"expand\", \"full\", 3, \"click\"]],\n    template: function ShoppingCartPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"ion-header\", 0);\n        i0.ɵɵelementStart(1, \"ion-toolbar\");\n        i0.ɵɵelementStart(2, \"ion-buttons\", 1);\n        i0.ɵɵelement(3, \"ion-back-button\", 2);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(4, \"ion-title\", 3);\n        i0.ɵɵtext(5, \"Cart\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"ion-content\", 4);\n        i0.ɵɵelementStart(7, \"ion-grid\", 5);\n        i0.ɵɵtemplate(8, ShoppingCartPage_div_8_Template, 10, 6, \"div\", 6);\n        i0.ɵɵtemplate(9, ShoppingCartPage_div_9_Template, 10, 0, \"div\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(10, ShoppingCartPage_ion_footer_10_Template, 7, 0, \"ion-footer\", 6);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(8);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedItems.length);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", !ctx.selectedItems.length);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.selectedItems.length);\n      }\n    },\n    directives: [i4.IonHeader, i4.IonToolbar, i4.IonButtons, i4.IonBackButton, i4.IonBackButtonDelegate, i4.IonTitle, i4.IonContent, i4.IonGrid, i5.NgIf, i4.IonList, i5.NgForOf, i4.IonItem, i4.IonLabel, i4.IonItemSliding, i4.IonThumbnail, i4.IonImg, i4.IonItemOptions, i4.IonItemOption, i4.IonIcon, i4.IonText, i4.IonButton, i4.RouterLinkDelegate, i3.RouterLink, i4.IonFooter],\n    pipes: [i5.CurrencyPipe],\n    styles: [\"ion-thumbnail[_ngcontent-%COMP%]{--size: 50px;border-radius:8px!important;background-color:#ddd}ion-thumbnail[_ngcontent-%COMP%]   ion-img[_ngcontent-%COMP%]{border-radius:8px!important}.fixedLabel[_ngcontent-%COMP%]{min-width:100%!important;max-width:100%!important}.logo-box[_ngcontent-%COMP%]{width:100%;height:200px;position:relative;overflow:hidden;margin-top:20%}.logo-box[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:140px;height:140px;top:0;bottom:0;right:0;left:0;margin:auto}.logo-box[_ngcontent-%COMP%]   ion-icon.notification[_ngcontent-%COMP%]{font-size:150px;position:absolute;width:140px;height:140px;top:0;bottom:0;right:0;left:0;margin:auto}\"]\n  });\n  return ShoppingCartPage;\n})();","map":null,"metadata":{},"sourceType":"module"}